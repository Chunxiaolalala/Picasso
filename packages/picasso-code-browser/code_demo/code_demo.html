<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code测试demo</title>
    <link rel="stylesheet" href="reset.css" />
</head>
<style>
    * {
        padding: 0;
        margin: 0;
    }
    img {
        display: block;
    }
    .layer:hover {
        outline: 1px solid red;
    }
</style>
<body>
    <div class="test-meature" id="test_meature">
    </div>
</body>
</html>
<script src="./code_demo.js"></script>
<script>
    const _generateHtml = (data) => {
        let html = [];
        for (let i = 0; i < data.length; i++) {
            let record = data[i];
            const style = Object.keys(record.style).map(ite=>`${ite}: ${record.style[ite]};`).join('');
            if (record.type === 'Image' && !(record.children?.length>0)) {
                html.push(`<img class="layer ${record.className}" style="${style}" src="./images/${record.value}"/>`);
            } else {
                // to be done
                const tag = 'div';

                html.push(`<${tag} class="layer ${record.className}" style="${style}">`);
                if (record.type === 'Text') {
                    record.value = record.value.replace(/ /ig, '&nbsp;');
                    html.push(record.value || '');
                }
                if(Array.isArray(record.children)) {
                    html.push(_generateHtml(record.children));
                }
                html.push(`</${tag}>`);
            }
        }
        return html.join('\n');
    }
    const _html = _generateHtml(dsl);

    document.getElementById('test_meature').innerHTML =_html;
</script>
